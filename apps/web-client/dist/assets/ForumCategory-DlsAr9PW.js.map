{"version":3,"file":"ForumCategory-DlsAr9PW.js","sources":["../../src/pages/ForumCategory.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\"\r\nimport { useParams, Link } from \"react-router-dom\"\r\nimport { User, MessageSquare, Clock, Pen, Pin, ArrowLeft } from \"lucide-react\"\r\nimport Loader from \"../components/UI/Loader\"\r\nimport { useTranslation } from 'react-i18next'\r\nimport Section from \"../components/Layout/Section\"\r\n\r\ninterface ThreadSummary {\r\n    id: string | number;\r\n    title: string;\r\n    author: string;\r\n    replies: number;\r\n    views: number;\r\n    lastActivity: string;\r\n    pinned: boolean;\r\n    tag: string | null;\r\n    slug?: string;\r\n}\r\n\r\ninterface NewsResponse {\r\n    id: string | number;\r\n    title: string;\r\n    replies?: number;\r\n    views?: number;\r\n    created_at: string;\r\n    category: string | null;\r\n    status: string;\r\n    slug?: string;\r\n}\r\n\r\ninterface ThreadResponse {\r\n    id: string | number;\r\n    title: string;\r\n    author_name?: string;\r\n    reply_count?: number;\r\n    views?: number;\r\n    created_at: string;\r\n    pinned?: boolean;\r\n    slug?: string;\r\n}\r\n\r\nconst categorySlugs = {\r\n    \"announcements\": 1,\r\n    \"general\": 2,\r\n    \"support\": 3,\r\n    \"off-topic\": 4\r\n}\r\n\r\nconst categoryTranslationKeys: Record<string, string> = {\r\n    \"announcements\": \"announcements\",\r\n    \"1\": \"announcements\",\r\n    \"news\": \"announcements\",\r\n    \"general\": \"general\",\r\n    \"2\": \"general\",\r\n    \"support\": \"support\",\r\n    \"3\": \"support\",\r\n    \"off-topic\": \"offtopic\",\r\n    \"4\": \"offtopic\"\r\n}\r\n\r\nexport default function ForumCategory() {\r\n    const { id: slug } = useParams<{ id: string }>()\r\n    const { t } = useTranslation()\r\n    const [threads, setThreads] = useState<ThreadSummary[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    // Fallback if slug not found - try to map slug to ID, or use it as ID if it is one\r\n    const categoryId = slug ? (categorySlugs[slug as keyof typeof categorySlugs] || slug) : null;\r\n    const translationKey = slug ? categoryTranslationKeys[slug] : null;\r\n    const categoryTitle = translationKey ? t(`forum_page.categories.${translationKey}.title`) : t('forum_page.categories.general.title')\r\n    const API_URL = import.meta.env.VITE_API_URL\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            setLoading(true)\r\n            if (!categoryId) {\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            if (String(categoryId) === \"1\") {\r\n                try {\r\n                    // Fetch real news for \"Anuncios\"\r\n                    const res = await fetch(`${API_URL}/news`)\r\n                    const data = await res.json()\r\n                    const mappedNews: ThreadSummary[] = Array.isArray(data) ? (data as NewsResponse[]).filter(n => n.status === 'Published').map(n => ({\r\n                        id: n.id,\r\n                        title: n.title,\r\n                        author: \"Staff\",\r\n                        replies: n.replies || 0,\r\n                        views: n.views || 0,\r\n                        lastActivity: new Date(n.created_at).toLocaleDateString(),\r\n                        pinned: true,\r\n                        tag: n.category,\r\n                        slug: n.slug\r\n                    })) : []\r\n                    setThreads(mappedNews)\r\n                } catch (err) {\r\n                    console.error(\"Error loading forum news:\", err)\r\n                } finally {\r\n                    setLoading(false)\r\n                }\r\n            } else {\r\n                try {\r\n                    // Fetch real user threads\r\n                    const res = await fetch(`${API_URL}/forum/category/${categoryId}`)\r\n                    const data = await res.json()\r\n                    const mappedThreads: ThreadSummary[] = Array.isArray(data) ? (data as ThreadResponse[]).map(t => ({\r\n                        id: t.id,\r\n                        title: t.title,\r\n                        author: t.author_name || \"An√≥nimo\",\r\n                        replies: t.reply_count || 0,\r\n                        views: t.views || 0,\r\n                        lastActivity: new Date(t.created_at).toLocaleDateString(),\r\n                        pinned: t.pinned || false,\r\n                        tag: null,\r\n                        slug: t.slug\r\n                    })) : []\r\n                    setThreads(mappedThreads)\r\n                } catch (err) {\r\n                    console.error(err)\r\n                } finally {\r\n                    setLoading(false)\r\n                }\r\n            }\r\n        }\r\n\r\n        fetchData()\r\n    }, [categoryId, slug, API_URL])\r\n\r\n    return (\r\n        <div className=\"pt-24 min-h-screen\">\r\n            <Section title={categoryTitle}>\r\n                <div className=\"max-w-4xl mx-auto\">\r\n                    {/* Header Controls */}\r\n                    <div className=\"flex justify-between items-center mb-8 bg-black/40 backdrop-blur-md p-4 rounded-2xl border border-white/5\">\r\n                        <Link \r\n                            to=\"/forum\" \r\n                            className=\"flex items-center gap-2 text-gray-400 hover:text-(--accent) transition-colors text-sm font-bold uppercase tracking-widest\"\r\n                        >\r\n                            <ArrowLeft /> {t('forum_category.back_link')}\r\n                        </Link>\r\n\r\n                        {String(categoryId) !== \"1\" && (\r\n                            <Link \r\n                                to=\"/forum/create\" \r\n                                className=\"flex items-center gap-2 px-6 py-3 bg-(--accent) text-black rounded-xl text-xs font-black uppercase tracking-widest hover:scale-105 transition-transform shadow-lg shadow-(--accent)/20\"\r\n                            >\r\n                                <Pen /> {t('forum_category.new_thread')}\r\n                            </Link>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Content */}\r\n                    {loading ? (\r\n                        <div className=\"py-20 flex flex-col items-center justify-center gap-4\">\r\n                            <div className=\"w-12 h-12 border-4 border-white/10 border-t-(--accent) rounded-full animate-spin\"></div>\r\n                            <Loader text={t('forum_category.loading')} />\r\n                        </div>\r\n                    ) : threads.length === 0 ? (\r\n                        <div className=\"py-20 flex flex-col items-center justify-center gap-6 bg-white/2 border border-dashed border-white/10 rounded-3xl\">\r\n                            <MessageSquare className=\"text-6xl text-white/10\" />\r\n                            <div className=\"text-center\">\r\n                                <p className=\"text-gray-400 font-medium mb-4\">{t('forum_category.no_threads')}</p>\r\n                                {String(categoryId) !== '1' && (\r\n                                    <Link \r\n                                        to=\"/forum/create\" \r\n                                        className=\"text-(--accent) font-bold hover:underline\"\r\n                                    >\r\n                                        {t('forum_category.be_first')}\r\n                                    </Link>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col gap-4\">\r\n                            {threads.map(thread => (\r\n                                <Link \r\n                                    to={String(categoryId) === \"1\" ? `/forum/thread/news/${thread.slug || thread.id}` : `/forum/thread/topic/${thread.slug || thread.id}`} \r\n                                    key={thread.id} \r\n                                    className=\"group block\"\r\n                                >\r\n                                    <div className=\"bg-black/40 backdrop-blur-xl border border-white/5 rounded-2xl p-6 flex items-center gap-6 transition-all duration-300 hover:bg-white/5 hover:border-(--accent)/30 hover:-translate-y-1 hover:shadow-xl hover:shadow-(--accent)/5\">\r\n                                        \r\n                                        {/* Icon */}\r\n                                        <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl shrink-0 ${thread.pinned ? 'bg-(--accent)/10 text-(--accent)' : 'bg-white/5 text-gray-500 group-hover:bg-white/10 group-hover:text-gray-300'}`}>\r\n                                            {thread.pinned ? <Pin className=\"rotate-45\" /> : <MessageSquare />}\r\n                                        </div>\r\n\r\n                                        {/* Info */}\r\n                                        <div className=\"grow min-w-0\">\r\n                                            <div className=\"flex items-center gap-3 mb-2\">\r\n                                                {thread.tag && (\r\n                                                    <span className=\"bg-(--accent) text-black px-2 py-0.5 rounded text-[10px] font-black uppercase tracking-widest shrink-0\">\r\n                                                        {thread.tag}\r\n                                                    </span>\r\n                                                )}\r\n                                                <h3 className=\"text-lg font-bold text-white group-hover:text-(--accent) transition-colors truncate\">\r\n                                                    {thread.title}\r\n                                                </h3>\r\n                                            </div>\r\n                                            \r\n                                            <div className=\"flex items-center gap-6 text-xs font-bold text-gray-500 uppercase tracking-widest\">\r\n                                                <span className=\"flex items-center gap-2\">\r\n                                                    <User className=\"text-(--accent)/50\" /> {thread.author}\r\n                                                </span>\r\n                                                <span className=\"flex items-center gap-2\">\r\n                                                    <Clock className=\"text-(--accent)/50\" /> {thread.lastActivity}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Stats */}\r\n                                        <div className=\"gap-8 text-center shrink-0 border-l border-white/5 pl-8 hidden sm:flex\">\r\n                                            <div className=\"flex flex-col\">\r\n                                                <span className=\"text-xl font-black text-white group-hover:text-(--accent) transition-colors\">{thread.replies}</span>\r\n                                                <span className=\"text-[10px] text-gray-500 uppercase tracking-widest\">{t('forum_category.replies')}</span>\r\n                                            </div>\r\n                                            <div className=\"flex flex-col\">\r\n                                                <span className=\"text-xl font-black text-white group-hover:text-(--accent) transition-colors\">{thread.views}</span>\r\n                                                <span className=\"text-[10px] text-gray-500 uppercase tracking-widest\">{t('forum_category.views')}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </Link>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </Section>\r\n        </div>\r\n    )\r\n}\r\n"],"names":["categorySlugs","categoryTranslationKeys","ForumCategory","slug","useParams","t","useTranslation","threads","setThreads","useState","loading","setLoading","categoryId","translationKey","categoryTitle","API_URL","useEffect","data","mappedNews","n","err","mappedThreads","jsx","Section","jsxs","Link","ArrowLeft","Pen","Loader","MessageSquare","thread","Pin","User","Clock"],"mappings":"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"}