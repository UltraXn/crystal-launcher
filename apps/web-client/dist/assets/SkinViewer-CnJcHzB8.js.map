{"version":3,"file":"SkinViewer-CnJcHzB8.js","sources":["../../src/components/Widgets/SkinViewer.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\r\nimport { SkinViewer, IdleAnimation, WalkingAnimation } from 'skinview3d';\r\n\r\ninterface SkinViewerProps {\r\n    skinUrl: string;\r\n    width?: number;\r\n    height?: number;\r\n}\r\n\r\nconst SkinViewerComponent = ({ skinUrl, width = 300, height = 400 }: SkinViewerProps) => {\r\n    const [isVisible, setIsVisible] = useState(false);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const viewerRef = useRef<SkinViewer | null>(null);\r\n\r\n    // 1. Observer for visibility\r\n    useEffect(() => {\r\n        const observer = new IntersectionObserver(\r\n            ([entry]) => {\r\n                setIsVisible(entry.isIntersecting);\r\n            },\r\n            { rootMargin: '100px 0px' } // Pre-load slightly before appearing\r\n        );\r\n\r\n        if (containerRef.current) {\r\n            observer.observe(containerRef.current);\r\n        }\r\n\r\n        return () => {\r\n             observer.disconnect();\r\n        };\r\n    }, []);\r\n\r\n    // 2. Initialize Viewer when visible\r\n    useEffect(() => {\r\n        if (!isVisible || !canvasRef.current) return;\r\n\r\n        let viewer: SkinViewer | null = null;\r\n\r\n        // Initialize\r\n        try {\r\n            viewer = new SkinViewer({\r\n                canvas: canvasRef.current,\r\n                width: width,\r\n                height: height,\r\n                skin: skinUrl,\r\n            });\r\n\r\n            // Animation\r\n            if (typeof IdleAnimation !== 'undefined') {\r\n                viewer.animation = new IdleAnimation();\r\n                viewer.animation.paused = true;\r\n            } else if (typeof WalkingAnimation !== 'undefined') {\r\n                viewer.animation = new WalkingAnimation();\r\n                viewer.animation.paused = true;\r\n            }\r\n\r\n            // Controls\r\n            viewer.controls.enableZoom = true;\r\n            viewer.camera.position.z = 60;\r\n            viewer.controls.target.y = 5;\r\n\r\n            viewerRef.current = viewer;\r\n        } catch (error) {\r\n            console.error(\"Failed to initialize SkinViewer\", error);\r\n        }\r\n\r\n        // Cleanup function\r\n        return () => {\r\n            if (viewer) {\r\n                viewer.dispose();\r\n                viewerRef.current = null;\r\n            }\r\n        };\r\n    }, [isVisible, skinUrl, width, height]);\r\n\r\n    return (\r\n        <div ref={containerRef} className=\"skin-viewer-container\" style={{ width: width, height: height, position: 'relative', zIndex: 2 }}>\r\n            {isVisible && (\r\n                <canvas ref={canvasRef} style={{ width: '100%', height: '100%' }} />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SkinViewerComponent;\r\n"],"names":["SkinViewerComponent","skinUrl","width","height","isVisible","setIsVisible","useState","containerRef","useRef","canvasRef","viewerRef","useEffect","observer","entry","viewer","SkinViewer","IdleAnimation","WalkingAnimation","error","jsx"],"mappings":"yJASA,MAAMA,EAAsB,CAAC,CAAE,QAAAC,EAAS,MAAAC,EAAQ,IAAK,OAAAC,EAAS,OAA2B,CACrF,KAAM,CAACC,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAK,EAC1CC,EAAeC,EAAAA,OAAuB,IAAI,EAC1CC,EAAYD,EAAAA,OAA0B,IAAI,EAC1CE,EAAYF,EAAAA,OAA0B,IAAI,EAGhDG,OAAAA,EAAAA,UAAU,IAAM,CACZ,MAAMC,EAAW,IAAI,qBACjB,CAAC,CAACC,CAAK,IAAM,CACTR,EAAaQ,EAAM,cAAc,CACrC,EACA,CAAE,WAAY,WAAA,CAAY,EAG9B,OAAIN,EAAa,SACbK,EAAS,QAAQL,EAAa,OAAO,EAGlC,IAAM,CACRK,EAAS,WAAA,CACd,CACJ,EAAG,CAAA,CAAE,EAGLD,EAAAA,UAAU,IAAM,CACZ,GAAI,CAACP,GAAa,CAACK,EAAU,QAAS,OAEtC,IAAIK,EAA4B,KAGhC,GAAI,CACAA,EAAS,IAAIC,EAAW,CACpB,OAAQN,EAAU,QAClB,MAAAP,EACA,OAAAC,EACA,KAAMF,CAAA,CACT,EAGG,OAAOe,EAAkB,KACzBF,EAAO,UAAY,IAAIE,EACvBF,EAAO,UAAU,OAAS,IACnB,OAAOG,EAAqB,MACnCH,EAAO,UAAY,IAAIG,EACvBH,EAAO,UAAU,OAAS,IAI9BA,EAAO,SAAS,WAAa,GAC7BA,EAAO,OAAO,SAAS,EAAI,GAC3BA,EAAO,SAAS,OAAO,EAAI,EAE3BJ,EAAU,QAAUI,CACxB,OAASI,EAAO,CACZ,QAAQ,MAAM,kCAAmCA,CAAK,CAC1D,CAGA,MAAO,IAAM,CACLJ,IACAA,EAAO,QAAA,EACPJ,EAAU,QAAU,KAE5B,CACJ,EAAG,CAACN,EAAWH,EAASC,EAAOC,CAAM,CAAC,EAGlCgB,EAAAA,IAAC,MAAA,CAAI,IAAKZ,EAAc,UAAU,wBAAwB,MAAO,CAAE,MAAAL,EAAc,OAAAC,EAAgB,SAAU,WAAY,OAAQ,GAC1H,SAAAC,GACGe,EAAAA,IAAC,SAAA,CAAO,IAAKV,EAAW,MAAO,CAAE,MAAO,OAAQ,OAAQ,MAAA,CAAO,CAAG,CAAA,CAE1E,CAER"}