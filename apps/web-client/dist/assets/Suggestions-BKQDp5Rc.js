import{j as e,F as u,av as C,J as h,aH as T,T as P}from"./ui-vendor-bChcnJbH.js";import{r as i}from"./react-vendor-C4HomasF.js";import{g as $,a8 as f}from"./index-0L0CuJC5.js";import{u as z,a as V}from"./zod-CBLu0rk-.js";import{o as E,s as b,_ as M,u as O}from"./utils-vendor-DpehPmnF.js";const A=E({nickname:b().min(3,"Nickname required (min 3 chars)").max(50),type:M(["General","Bug","Mod","Complaint","Poll","other","server","web","discord"]),message:b().min(10,"Message must be at least 10 characters").max(2e3,"Message too long")}),d="/api";function L(){const{t:s}=O(),[m,c]=i.useState("idle"),{register:x,handleSubmit:j,reset:w,formState:{errors:o,isSubmitting:p}}=z({resolver:V(A),defaultValues:{nickname:"",type:"General",message:""}}),[a,g]=i.useState(null),[N,v]=i.useState(!0),[r,y]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const l=await fetch(`${d}/polls/active`);if(l.ok){const n=await l.json();n&&n.success&&g(n.data)}}catch(l){console.error("Error fetching poll",l)}finally{v(!1)}})(),$.fromTo(".suggestion-column, .polls-column",{opacity:0,y:30},{opacity:1,y:0,stagger:.2,duration:1,ease:"power3.out",delay:.3})},[]);const k=async t=>{if(!(r||!a))try{if((await fetch(`${d}/polls/vote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pollId:a.id,optionId:t})})).ok){y(!0);const _=await(await fetch(`${d}/polls/active`)).json();g(_.data)}}catch(l){console.error(l)}},S=async t=>{try{(await fetch(`${d}/suggestions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(c("success"),w()):(c("error"),setTimeout(()=>c("idle"),3e3))}catch{c("error"),setTimeout(()=>c("idle"),3e3)}};return e.jsx(f,{title:s("suggestions.title"),children:e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-12 max-w-[1400px] mx-auto px-4",children:[e.jsxs("div",{className:"lg:col-span-3 suggestion-column",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-(--accent)/10 flex items-center justify-center text-(--accent) text-xl border border-(--accent)/20",children:e.jsx(u,{})}),e.jsx("h3",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:s("suggestions.form_title")})]}),e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-[2.5rem] p-8 md:p-12 backdrop-blur-sm",children:m==="success"?e.jsxs("div",{className:"text-center animate-scale-in py-10",children:[e.jsx(C,{size:60,className:"text-emerald-400 mx-auto mb-6"}),e.jsx("h4",{className:"text-3xl font-black text-white mb-3 uppercase tracking-tight",children:s("suggestions.form.received")}),e.jsx("p",{className:"text-gray-400 font-medium leading-relaxed max-w-md mx-auto mb-8",children:s("suggestions.form.success_msg")}),e.jsx("button",{onClick:()=>c("idle"),className:"px-10 py-4 bg-white text-black rounded-full font-black uppercase tracking-widest text-sm transition-all hover:bg-(--accent) hover:scale-105 active:scale-95 shadow-xl",children:s("suggestions.form.send_another")})]}):e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:j(S),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-4",children:s("suggestions.form.nick")}),e.jsx("input",{type:"text",className:"bg-black/20 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-(--accent) transition-all placeholder:text-white/10",placeholder:s("suggestions.form.nick_placeholder"),...x("nickname")}),o.nickname&&e.jsx("span",{className:"text-red-500 text-[10px] font-bold uppercase ml-4",children:o.nickname.message})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-4",children:s("suggestions.form.type")}),e.jsxs("select",{className:"bg-black/20 border border-white/10 rounded-2xl px-6 py-4 text-white focus:outline-none focus:border-(--accent) transition-all appearance-none cursor-pointer",...x("type"),children:[e.jsx("option",{value:"General",className:"bg-[#0a0a0a]",children:s("suggestions.form.options.general")}),e.jsx("option",{value:"Bug",className:"bg-[#0a0a0a]",children:s("suggestions.form.options.bug")}),e.jsx("option",{value:"Mod",className:"bg-[#0a0a0a]",children:s("suggestions.form.options.mod")}),e.jsx("option",{value:"Complaint",className:"bg-[#0a0a0a]",children:s("suggestions.form.options.complaint")}),e.jsx("option",{value:"Poll",className:"bg-[#0a0a0a]",children:s("suggestions.form.options.poll")})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-4",children:s("suggestions.form.msg")}),e.jsx("textarea",{className:"bg-black/20 border border-white/10 rounded-3xl px-6 py-4 text-white focus:outline-none focus:border-(--accent) transition-all placeholder:text-white/10 min-h-[200px] resize-none",placeholder:s("suggestions.form.msg_placeholder"),...x("message")}),o.message&&e.jsx("span",{className:"text-red-500 text-[10px] font-bold uppercase ml-4",children:o.message.message})]}),e.jsx("button",{type:"submit",className:"bg-white text-black py-5 rounded-2xl font-black uppercase tracking-widest mt-4 transition-all hover:bg-(--accent) hover:scale-[1.02] active:scale-95 shadow-xl shadow-black disabled:opacity-50",disabled:p,children:p?e.jsxs("span",{className:"flex items-center justify-center gap-3",children:[e.jsx(h,{className:"animate-spin"})," ",s("suggestions.form.sending")]}):e.jsxs("span",{className:"flex items-center justify-center gap-3",children:[e.jsx(u,{className:"text-xs"})," ",s("suggestions.form.submit")]})}),m==="error"&&e.jsx("p",{className:"text-red-500 text-center font-bold uppercase tracking-widest text-xs mt-4",children:s("suggestions.form.error_msg")})]})})]}),e.jsxs("div",{className:"lg:col-span-2 polls-column",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-(--accent)/10 flex items-center justify-center text-(--accent) text-xl border border-(--accent)/20",children:e.jsx(T,{})}),e.jsx("h3",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:s("suggestions.poll_title")})]}),N?e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[2.5rem] p-12 flex flex-col items-center justify-center gap-4",children:[e.jsx(h,{className:"animate-spin text-white/20",size:32}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-xs",children:s("suggestions.loading_poll")})]}):a?e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[2.5rem] p-8 md:p-10 backdrop-blur-xl flex flex-col gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-(--accent) text-[10px] font-black uppercase tracking-[0.2em] mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-(--accent) animate-pulse"}),a.title]}),e.jsx("h4",{className:"text-2xl font-black text-white leading-tight uppercase tracking-tight",children:a.question})]}),e.jsx("div",{className:"flex flex-col gap-4",children:(a.options||[]).map(t=>e.jsxs("div",{className:`relative group h-14 bg-white/5 border border-white/5 rounded-2xl overflow-hidden transition-all ${r?"cursor-default":"cursor-pointer hover:bg-white/10 hover:border-white/20 active:scale-95"}`,onClick:()=>k(t.id),children:[e.jsx("div",{className:`absolute left-0 inset-y-0 transition-all duration-1000 ease-out-expo ${r?"bg-white/10 opacity-100":"bg-(--accent)/20 opacity-0 group-hover:opacity-100"}`,style:{width:r?`${t.percent}%`:"0%"}}),e.jsxs("div",{className:"relative z-10 h-full flex items-center justify-between px-6 pointer-events-none",children:[e.jsx("span",{className:`text-sm font-black uppercase tracking-widest transition-colors ${r?"text-white":"text-gray-400"}`,children:t.label}),r&&e.jsx("span",{className:"text-(--accent) font-mono font-bold",children:a.totalVotes>0?`${t.percent}%`:"0%"})]})]},t.id))}),e.jsxs("div",{className:"pt-6 border-t border-white/5 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest text-gray-500 px-2",children:[e.jsxs("span",{children:["Total: ",a.totalVotes," votos"]}),e.jsxs("span",{children:["Cierra en: ",a.closesIn]})]}),r&&e.jsx("p",{className:"text-emerald-400 text-center text-xs font-black uppercase tracking-widest animate-bounce",children:s("suggestions.thanks_vote")})]})]}):e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[2.5rem] p-12 flex flex-col items-center justify-center gap-6 text-center opacity-50",children:[e.jsx(P,{size:48,className:"text-white/10"}),e.jsx("p",{className:"text-gray-400 font-bold uppercase tracking-widest text-sm max-w-[200px] leading-relaxed",children:s("suggestions.no_active_poll")})]})]})]})})})}export{L as default};
//# sourceMappingURL=Suggestions-BKQDp5Rc.js.map
