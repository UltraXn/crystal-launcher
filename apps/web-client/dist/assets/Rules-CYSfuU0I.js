import{j as e,br as T,R as Z,X as q,J as y,aA as v,aW as W,aG as V,P as X,k as Y,bs as G,bt as H,aa as K,bu as Q,d as ee,bv as te,bw as se,a7 as ae,bx as re,I as oe,aw as ne}from"./ui-vendor-bChcnJbH.js";import{r as x}from"./react-vendor-C4HomasF.js";import{u as le,g as ce,a8 as ie,L as de,s as S}from"./index-0L0CuJC5.js";import{u as xe}from"./utils-vendor-DpehPmnF.js";const N="/api",ue=async()=>{try{const s=await fetch(`${N}/rules`);if(!s.ok)throw new Error("Failed to fetch rules");const d=s.headers.get("content-type");if(d&&d.includes("application/json")){const r=await s.json();return r.success?r.data:[]}return[]}catch(s){throw s}},pe=async(s,d)=>{var l;const r=await fetch(`${N}/rules`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(s)}),i=r.headers.get("content-type");let c;if(i&&i.includes("application/json"))c=await r.json();else{const h=await r.text();throw new Error(h||`Error ${r.status}`)}if(!r.ok)throw new Error(((l=c==null?void 0:c.error)==null?void 0:l.message)||(c==null?void 0:c.message)||"Failed to create rule");return c.data},he=async(s,d,r)=>{var h;const i=await fetch(`${N}/rules/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(d)}),c=i.headers.get("content-type");let l;if(c&&c.includes("application/json"))l=await i.json();else{const g=await i.text();throw new Error(g||`Error ${i.status}`)}if(!i.ok)throw new Error(((h=l==null?void 0:l.error)==null?void 0:h.message)||(l==null?void 0:l.message)||"Failed to update rule");return l.data},ge=async(s,d)=>{var i;const r=await fetch(`${N}/rules/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${d}`}});if(!r.ok){const c=r.headers.get("content-type");if(c&&c.includes("application/json")){const l=await r.json();throw new Error(((i=l.error)==null?void 0:i.message)||l.message||"Failed to delete rule")}else{const l=await r.text();throw new Error(l||`Error ${r.status}`)}}},me="/api",z={General:{icon:e.jsx(oe,{size:18}),color:"#6366f1"},Comportamiento:{icon:e.jsx(re,{size:18}),color:"#f87171"},Chat:{icon:e.jsx(ae,{size:18}),color:"#4ade80"},PvP:{icon:e.jsx(se,{size:18}),color:"#fb923c"},Construcción:{icon:e.jsx(te,{size:18}),color:"#2dd4bf"},Modificaciones:{icon:e.jsx(G,{size:18}),color:"#a78bfa"},Staff:{icon:e.jsx(T,{size:18}),color:"#f472b6"},Seguridad:{icon:e.jsx(ee,{size:18}),color:"#10b981"},Contenido:{icon:e.jsx(Q,{size:18}),color:"#fcd34d"},Economía:{icon:e.jsx(T,{size:18}),color:"#34d399"},Mundo:{icon:e.jsx(K,{size:18}),color:"#60a5fa"},Cuenta:{icon:e.jsx(H,{size:18}),color:"#94a3b8"},Discord:{icon:e.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 640 512",height:"18",width:"18",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.8,167.234,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"})}),color:"#5865F2"},Estética:{icon:e.jsx(G,{size:18}),color:"#f472b6"},Comunidad:{icon:e.jsx(Y,{size:18}),color:"#fb7185"}},F={icon:e.jsx(ne,{size:18}),color:"#94a3b8"};function Ne(){var P,L;const{t:s,i18n:d}=xe(),{user:r}=le(),[i,c]=x.useState([]),[l,h]=x.useState(!0),[g,A]=x.useState(null),[R,m]=x.useState(!1),[b,k]=x.useState(null),[o,u]=x.useState({category:"General",title:"",title_en:"",content:"",content_en:"",color:"",sort_order:0}),[p,$]=x.useState(null),I=["admin","developer","neroferno","killu","helper"].includes(((L=(P=r==null?void 0:r.user_metadata)==null?void 0:P.role)==null?void 0:L.toLowerCase())||""),_=async()=>{h(!0);try{const t=await ue();c(t)}catch(t){console.error("Failed to load rules:",t)}finally{h(!1)}};x.useEffect(()=>{_()},[]);const C=x.useMemo(()=>[...i].sort((a,n)=>(a.sort_order||0)!==(n.sort_order||0)?(a.sort_order||0)-(n.sort_order||0):(a.category||"").localeCompare(n.category||"")).map((a,n)=>({...a,globalIndex:n+1})),[i]),f=x.useMemo(()=>g?C.filter(t=>t.category===g):C,[C,g]),w=async(t,a,n)=>{var j;if(t){$(n);try{const E=(j=(await S.auth.getSession()).data.session)==null?void 0:j.access_token,O=await(await fetch(`${me}/translation`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({text:t,targetLang:a})})).json();O.success&&u(J=>({...J,[n]:O.translatedText}))}catch(E){console.error("Translation fail",E)}finally{$(null)}}};x.useEffect(()=>{f.length!==0&&ce.fromTo(".rule-card-premium",{opacity:0,scale:.95,y:30},{opacity:1,scale:1,y:0,stagger:.08,duration:.6,ease:"power3.out",clearProps:"all"})},[f]);const M=async()=>{var t;if(r)try{const a=(t=(await S.auth.getSession()).data.session)==null?void 0:t.access_token;if(!a)throw new Error("No token");b?await he(b,o,a):await pe(o,a),u({category:"General",title:"",title_en:"",content:"",content_en:"",color:"",sort_order:0}),k(null),m(!1),_()}catch(a){const n=a instanceof Error?a.message:String(a);alert("Error al guardar: "+n)}},U=async t=>{var a;if(confirm(s("common.confirm_delete","¿Seguro que quieres borrar este elemento?"))&&r)try{const n=(a=(await S.auth.getSession()).data.session)==null?void 0:a.access_token;if(!n)throw new Error("No token");await ge(t,n),_()}catch(n){const j=n instanceof Error?n.message:String(n);alert(s("rules.delete_error","Error al borrar")+": "+j)}},B=t=>{u(t),k(t.id),m(!0),window.scrollTo({top:0,behavior:"smooth"})},D=Array.from(new Set(i.map(t=>t.category||"General")));return e.jsxs(ie,{title:s("rules.title")||"Normas del Servidor",children:[e.jsxs("div",{className:"flex flex-col items-center w-full pb-20 relative z-10",children:[e.jsxs("div",{className:"w-full max-w-3xl mx-auto text-center mb-16",children:[e.jsx("p",{className:"text-gray-400 text-lg leading-relaxed mb-12",children:s("rules.intro")||"Para mantener una comunidad sana y divertida, es fundamental respetar estas normas de convivencia. El incumplimiento puede llevar a sanciones severas."}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-8 p-1.5 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-xl shadow-2xl",children:[e.jsxs("button",{onClick:()=>A(null),className:`px-5 py-2.5 rounded-xl text-xs font-black uppercase tracking-widest transition-all duration-300 flex items-center gap-2 ${g?"text-gray-400 hover:text-white hover:bg-white/5":"bg-(--accent) text-black shadow-lg shadow-(--accent)/30"}`,children:[e.jsx(T,{size:14})," ",s("rules.all","Todas")]}),D.map(t=>{const a=z[t]||F;return e.jsxs("button",{onClick:()=>A(t),className:`px-5 py-2.5 rounded-xl text-xs font-black uppercase tracking-widest transition-all duration-300 flex items-center gap-2 ${g===t?"bg-(--accent) text-black shadow-lg shadow-(--accent)/30":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[a.icon," ",s(`rules.categories.${t.toLowerCase()}`,t)]},t)})]}),I&&!R&&e.jsxs("button",{onClick:()=>{m(!0),k(null),u({category:"General",title:"",title_en:"",content:"",content_en:"",color:"",sort_order:0})},className:"bg-white text-black px-10 py-4 rounded-full font-black uppercase tracking-widest text-sm transition-all hover:bg-(--accent) hover:scale-105 shadow-xl",children:[e.jsx(Z,{className:"inline mr-2",size:16})," ",s("rules.new_rule","Nueva Normativa")]})]}),R&&e.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-[#0a0a0a] border border-white/10 rounded-3xl p-8 mb-20 shadow-2xl backdrop-blur-3xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-10 border-b border-white/5 pb-6",children:[e.jsx("h3",{className:"text-2xl font-black uppercase tracking-widest text-(--accent)",children:b?s("rules.editing","Editando Norma"):s("rules.new_norm","Nueva Norma")}),e.jsxs("button",{onClick:()=>m(!1),className:"px-4 py-2 text-xs font-bold uppercase text-white/50 hover:text-white transition-colors flex items-center gap-2",children:[e.jsx(q,{size:14})," ",s("rules.close","Cerrar")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 text-left",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-4",children:s("rules.category","Categoría")}),e.jsx("input",{type:"text",list:"category-suggestions",className:"bg-white/5 border border-white/10 rounded-xl px-5 py-4 text-white focus:outline-none focus:border-(--accent) transition-colors",value:o.category,onChange:t=>u({...o,category:t.target.value}),placeholder:s("rules.cat_placeholder","Ej: PvP, Chat, Construcción...")}),e.jsx("datalist",{id:"category-suggestions",children:Object.keys(z).map(t=>e.jsx("option",{value:t},t))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500 ml-4",children:s("rules.sort_order","Orden de Visualización")}),e.jsx("input",{type:"number",className:"bg-white/5 border border-white/10 rounded-xl px-5 py-4 text-white focus:outline-none focus:border-(--accent) transition-colors",value:o.sort_order,onChange:t=>u({...o,sort_order:parseInt(t.target.value)||0})})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:s("rules.title_es","Título (Español)")}),e.jsxs("button",{type:"button",className:"text-[10px] font-black uppercase tracking-widest bg-(--accent)/10 text-(--accent) px-3 py-1 rounded-full border border-(--accent)/20 hover:bg-(--accent) hover:text-black transition-all disabled:opacity-50",onClick:()=>w(o.title||"","en","title_en"),disabled:!!p||!o.title,children:[p==="title_en"?e.jsx(y,{className:"animate-spin",size:14}):e.jsx(v,{className:"inline mr-1",size:14})," ",s("rules.translate_to_en","Traducir a EN")]})]}),e.jsx("input",{type:"text",className:"bg-white/5 border border-white/10 rounded-xl px-5 py-4 text-white focus:outline-none focus:border-(--accent) transition-colors",value:o.title,onChange:t=>u({...o,title:t.target.value}),placeholder:s("rules.title_placeholder_es","Título en español")})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s("rules.title_en","Título (Inglés)")," ",e.jsxs("span",{className:"opacity-40",children:["(",s("common.optional","Opcional"),")"]})]}),e.jsxs("button",{type:"button",className:"text-[10px] font-black uppercase tracking-widest bg-(--accent)/10 text-(--accent) px-3 py-1 rounded-full border border-(--accent)/20 hover:bg-(--accent) hover:text-black transition-all disabled:opacity-50",onClick:()=>w(o.title_en||"","es","title"),disabled:!!p||!o.title_en,children:[p==="title"?e.jsx(y,{className:"animate-spin",size:14}):e.jsx(v,{className:"inline mr-1",size:14})," ",s("rules.translate_to_es","Traducir a ES")]})]}),e.jsx("input",{type:"text",className:"bg-white/5 border border-white/10 rounded-xl px-5 py-4 text-white focus:outline-none focus:border-(--accent) transition-colors",value:o.title_en,onChange:t=>u({...o,title_en:t.target.value}),placeholder:s("rules.title_placeholder_en","English title")})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:s("rules.content_es","Contenido (Español)")}),e.jsxs("button",{type:"button",className:"text-[10px] font-black uppercase tracking-widest bg-(--accent)/10 text-(--accent) px-3 py-1 rounded-full border border-(--accent)/20 hover:bg-(--accent) hover:text-black transition-all disabled:opacity-50",onClick:()=>w(o.content||"","en","content_en"),disabled:!!p||!o.content,children:[p==="content_en"?e.jsx(y,{className:"animate-spin",size:14}):e.jsx(v,{className:"inline mr-1",size:14})," ",s("rules.translate_to_en","Traducir a EN")]})]}),e.jsx("textarea",{rows:4,className:"bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-(--accent) transition-colors resize-none",value:o.content,onChange:t=>u({...o,content:t.target.value}),placeholder:s("rules.content_placeholder_es","Contenido en español...")})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:[s("rules.content_en","Contenido (Inglés)")," ",e.jsxs("span",{className:"opacity-40",children:["(",s("common.optional","Opcional"),")"]})]}),e.jsxs("button",{type:"button",className:"text-[10px] font-black uppercase tracking-widest bg-(--accent)/10 text-(--accent) px-3 py-1 rounded-full border border-(--accent)/20 hover:bg-(--accent) hover:text-black transition-all disabled:opacity-50",onClick:()=>w(o.content_en||"","es","content"),disabled:!!p||!o.content_en,children:[p==="content"?e.jsx(y,{className:"animate-spin",size:14}):e.jsx(v,{className:"inline mr-1",size:14})," ",s("rules.translate_to_es","Traducir a ES")]})]}),e.jsx("textarea",{rows:4,className:"bg-white/5 border border-white/10 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-(--accent) transition-colors resize-none",value:o.content_en,onChange:t=>u({...o,content_en:t.target.value}),placeholder:s("rules.content_placeholder_en","English content...")})]}),e.jsxs("button",{onClick:M,className:"md:col-span-2 bg-(--accent) text-black py-5 rounded-2xl font-black uppercase tracking-widest mt-4 transition-all hover:scale-[1.02] active:scale-95 shadow-lg shadow-(--accent)/20 disabled:opacity-50",disabled:!!p,children:[e.jsx(W,{className:"inline mr-2",size:18})," ",b?s("rules.update_btn","ACTUALIZAR NORMA"):s("rules.publish_btn","PUBLICAR NORMA")]})]})]}),l?e.jsx("div",{className:"py-20",children:e.jsx(de,{text:s("rules.loading")||"Cargando normativas..."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 w-full max-w-[1400px] mx-auto",children:f.map(t=>{const a=z[t.category||"General"]||F,n=t.color||a.color;return e.jsxs("div",{className:"rule-card-premium relative p-8 bg-black/60 backdrop-blur-xl border border-white/5 rounded-3xl overflow-hidden hover:-translate-y-2 hover:shadow-2xl hover:shadow-(--accent)/10 hover:border-(--accent)/30 transition-all duration-300 h-full flex flex-col gap-6 group",children:[e.jsxs("div",{className:"absolute top-8 right-8 text-5xl font-black text-white/5 font-sans select-none group-hover:text-white/10 group-hover:scale-110 transition-all pointer-events-none",children:["#",String(t.globalIndex).padStart(2,"0")]}),I&&e.jsxs("div",{className:"absolute top-4 right-20 flex gap-2 opacity-0 group-hover:opacity-100 transition-all",children:[e.jsx("button",{onClick:()=>B(t),className:"w-8 h-8 rounded-lg bg-emerald-500/20 text-emerald-400 flex items-center justify-center hover:bg-emerald-500 hover:text-black transition-colors",children:e.jsx(V,{size:14})}),e.jsx("button",{onClick:()=>U(t.id),className:"w-8 h-8 rounded-lg bg-red-500/20 text-red-500 flex items-center justify-center hover:bg-red-500 hover:text-black transition-colors",children:e.jsx(X,{size:14})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-black uppercase tracking-[0.15em]",style:{color:n},children:[e.jsx("span",{className:"text-lg",children:a.icon}),e.jsx("span",{children:s(`rules.categories.${(t.category||"General").toLowerCase()}`,t.category||"General")})]}),e.jsx("h3",{className:"text-2xl font-black text-white leading-tight m-0 group-hover:text-(--accent) transition-colors",children:d.language==="en"&&t.title_en?t.title_en:t.title}),e.jsx("div",{className:"text-gray-400 text-sm leading-relaxed grow font-medium",children:d.language==="en"&&t.content_en?t.content_en:t.content}),e.jsxs("div",{className:"flex items-center justify-between pt-6 mt-4 border-t border-white/5",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-xl transition-all group-hover:scale-110 group-hover:-rotate-12",style:{color:n},children:a.icon}),e.jsx("div",{className:"flex-1 h-px bg-white/5 mx-4"})]}),e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1",style:{backgroundColor:n}})]},t.id)})}),!l&&f.length===0&&e.jsx("div",{className:"py-20 text-gray-500 font-bold uppercase tracking-widest",children:s("rules.no_results","No se encontraron normas en esta categoría.")})]}),e.jsxs("div",{className:"fixed inset-0 pointer-events-none z-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-[20%] -right-[5%] w-[600px] h-[600px] rounded-full bg-indigo-500/5 blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[10%] -left-[5%] w-[500px] h-[500px] rounded-full bg-(--accent)/5 blur-[100px]"})]})]})}export{Ne as default};
//# sourceMappingURL=Rules-CYSfuU0I.js.map
