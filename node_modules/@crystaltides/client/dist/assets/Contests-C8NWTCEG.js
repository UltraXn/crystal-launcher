import{j as e,aL as D,aN as C,av as S,aK as T,D as _,aM as $,by as L,aJ as I}from"./ui-vendor-bChcnJbH.js";import{u as z,r as h}from"./react-vendor-C4HomasF.js";import{u as O,a8 as F,s as M,g as B}from"./index-0L0CuJC5.js";import{C as R}from"./confetti.module-Bd1oGXMM.js";import{C as P}from"./ConfirmationModal-wVE31R5h.js";import{u as E}from"./utils-vendor-DpehPmnF.js";const A={hammer:e.jsx(C,{}),dice:e.jsx(I,{}),map:e.jsx(L,{}),running:e.jsx($,{})},q=({event:r,onRegister:d,registering:m,isRegistered:x})=>{const{t:c,i18n:f}=E(),{id:b,title:v,title_en:j,description:y,description_en:p,type:w,status:s}=r,g=c(s==="active"?"contests.status.active":s==="soon"?"contests.status.soon":"contests.status.finished"),N=f.language==="en"&&j?j:v,k=f.language==="en"&&p?p:y,a={active:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",soon:"bg-amber-500/20 text-amber-500 border-amber-500/30",finished:"bg-red-500/20 text-red-500 border-red-500/30"};return e.jsxs("div",{className:"group relative bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8 flex flex-col gap-6 overflow-hidden transition-all duration-500 hover:bg-white/5 hover:-translate-y-2 hover:shadow-2xl hover:shadow-(--accent)/20 hover:border-(--accent)/30",children:[e.jsx("div",{className:"absolute -right-8 -bottom-8 text-white/5 text-[180px] rotate-12 group-hover:scale-110 group-hover:text-white/10 transition-all pointer-events-none",children:A[w]||e.jsx(C,{})}),e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border ${a[s]}`,children:[s==="active"&&e.jsx(S,{className:"animate-pulse"}),s==="soon"&&e.jsx(D,{className:"animate-spin-slow"}),s==="finished"&&e.jsx(T,{}),e.jsx("span",{children:g})]})}),e.jsxs("div",{className:"relative z-10 flex flex-col gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl text-(--accent) group-hover:scale-110 group-hover:rotate-12 transition-all",children:A[w]||e.jsx(C,{})}),e.jsx("h3",{className:"text-2xl font-black text-white group-hover:text-(--accent) transition-colors",children:N}),e.jsx("p",{className:"text-gray-400 text-sm leading-relaxed font-medium line-clamp-4 italic",children:k})]}),e.jsx("div",{className:"mt-auto relative z-10",children:s==="active"||s==="soon"?e.jsx("button",{className:`w-full py-4 rounded-2xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all ${m||x?"bg-white/10 text-white/40 cursor-not-allowed":"bg-white text-black hover:bg-(--accent) hover:scale-105 active:scale-95 shadow-xl shadow-black/50"}`,onClick:()=>!x&&d(b),disabled:m||x,children:m?e.jsx(_,{className:"animate-bounce"}):x?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"text-emerald-500"})," ",c("contests.registered_btn")]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{})," ",c("contests.register_btn")]})}):e.jsx("button",{className:"w-full py-4 rounded-2xl font-black uppercase tracking-widest text-sm bg-black/40 text-white/20 border border-white/5 cursor-not-allowed",disabled:!0,children:c("contests.status.finished")})})]})};function Y(){const{t:r}=E(),{user:d}=O(),m=z(),[x,c]=h.useState([]),[f,b]=h.useState([]),[v,j]=h.useState(!0),[y,p]=h.useState(null),[w,s]=h.useState(!1),g="/api";h.useEffect(()=>{(async()=>{try{const n=await(await fetch(`${g}/events`)).json();if(Array.isArray(n)&&c(n),d){const{data:{session:i}}=await M.auth.getSession(),l=i==null?void 0:i.access_token;if(l){const o=await fetch(`${g}/events/my-registrations?userId=${d.id}`,{headers:{Authorization:`Bearer ${l}`}});if(o.ok){const u=await o.json();Array.isArray(u)&&b(u)}}}}catch(t){console.error("Error fetching data:",t)}finally{j(!1),setTimeout(()=>{document.querySelectorAll(".contest-card").length>0&&B.fromTo(".contest-card",{opacity:0,y:30,scale:.9},{opacity:1,y:0,scale:1,stagger:.1,duration:1.2,ease:"elastic.out(1, 0.75)",delay:.2})},100)}})()},[d,g]);const N=async a=>{if(!d){s(!0);return}p(a);try{const{data:{session:t}}=await M.auth.getSession(),n=t==null?void 0:t.access_token;if(!n)throw new Error("No hay sesión activa");const i=await fetch(`${g}/events/${a}/register`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({userId:d.id})}),l=await i.json();if(i.ok)k(),b(o=>[...o,a]);else if(l.error&&l.error.includes("Ya estás inscrito"))alert(r("contests.already_registered"));else throw new Error(l.error||r("contests.registration_error"))}catch(t){console.error("Registration error:",t);const n=t instanceof Error?t.message:String(t);alert(n)}finally{p(null)}},k=()=>{const t=Date.now()+3e3,n={startVelocity:30,spread:360,ticks:60,zIndex:0},i=function(o,u){return Math.random()*(u-o)+o},l=setInterval(function(){const o=t-Date.now();if(o<=0)return clearInterval(l);const u=50*(o/3e3);R(Object.assign({},n,{particleCount:u,origin:{x:i(.1,.3),y:Math.random()-.2}})),R(Object.assign({},n,{particleCount:u,origin:{x:i(.7,.9),y:Math.random()-.2}}))},250)};return e.jsx("div",{className:"pt-24 min-h-screen",children:e.jsxs(F,{title:r("contests.title"),children:[e.jsx("div",{className:"max-w-3xl mx-auto mb-16 p-8 bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl shadow-xl text-center",children:e.jsx("p",{className:"text-gray-300 text-lg leading-relaxed",children:r("contests.intro")})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 px-4",children:v?e.jsx("div",{className:"col-span-full py-20 flex justify-center",children:e.jsx("span",{className:"text-white/20 font-black uppercase tracking-tighter text-4xl animate-pulse",children:"Cargando eventos..."})}):x.length>0?x.map(a=>e.jsx(q,{event:a,onRegister:N,registering:y===a.id,isRegistered:f.includes(a.id)},a.id)):e.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center border-2 border-dashed border-white/5 rounded-3xl bg-white/2",children:[e.jsx("span",{className:"text-gray-500 font-black uppercase tracking-widest text-sm mb-4",children:r("contests.no_events")}),e.jsx(D,{className:"text-4xl text-gray-700 animate-pulse"})]})}),e.jsx(P,{isOpen:w,onClose:()=>s(!1),onConfirm:()=>{s(!1),m("/login")},title:r("login.title"),message:r("contests.login_required"),confirmText:r("login.sign_in_verb"),cancelText:"Cancelar"})]})})}export{Y as default};
//# sourceMappingURL=Contests-C8NWTCEG.js.map
